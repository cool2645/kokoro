{"version":3,"file":"kokoro.esm.js","sources":["../src/actions/player.js","../src/actions/playing.js","../src/constants.js","../src/actions/playlist.js","../src/reducers/player.js","../src/reducers/playlist.js","../src/reducers/playing.js","../src/reducers/index.js","../src/index.js"],"sourcesContent":["export const SET_VOLUME = 'SET_VOLUME'\nexport const SET_SPEED = 'SET_SPEED'\n\nexport function setVolume (volume) {\n  return {\n    type: SET_VOLUME,\n    payload: volume\n  }\n}\n\nexport function setSpeed (speed) {\n  return {\n    type: SET_SPEED,\n    payload: speed\n  }\n}\n","export const PAUSE = 'PAUSE'\nexport const PLAY = 'PLAY'\nexport const TOGGLE_PLAY = 'TOGGLE_PLAY'\nexport const SET_CURRENT_TIME = 'SET_CURRENT_TIME'\nexport const SET_TOTAL_TIME = 'SET_TOTAL_TIME'\nexport const SET_BUFFERED_TIME = 'SET_BUFFERED_TIME'\nexport const SET_TIMES = 'SET_TIMES'\nexport const NEXT_SRC = 'NEXT_SRC'\n\nexport function pause () {\n  return {\n    type: PAUSE\n  }\n}\n\nexport function play () {\n  return {\n    type: PLAY\n  }\n}\n\nexport function togglePlay () {\n  return {\n    type: TOGGLE_PLAY\n  }\n}\n\nexport function setCurrentTime (time) {\n  return {\n    type: SET_CURRENT_TIME,\n    payload: time\n  }\n}\n\nexport function setTotalTime (time) {\n  return {\n    type: SET_TOTAL_TIME,\n    payload: time\n  }\n}\n\nexport function setBufferedTime (buffered) {\n  return {\n    type: SET_BUFFERED_TIME,\n    payload: buffered\n  }\n}\n\nexport function setTimes (times) {\n  return {\n    type: SET_TIMES,\n    payload: times\n  }\n}\n\nexport function nextSrc () {\n  return {\n    type: NEXT_SRC\n  }\n}\n","export const LYRICS_TYPE_LRC = 'lrc'\nexport const LYRICS_TYPE_L2C = 'l2c'\nexport const PLAY_ORDER_LOOP = 'PLAY_ORDER_LOOP'\nexport const PLAY_ORDER_SINGLE = 'PLAY_ORDER_SINGLE'\nexport const PLAY_ORDER_SHUFFLE = 'PLAY_ORDER_SHUFFLE'\nexport const PLAY_ORDER = [\n  PLAY_ORDER_LOOP,\n  PLAY_ORDER_SHUFFLE,\n  PLAY_ORDER_SINGLE\n]\n","import { PLAY_ORDER, PLAY_ORDER_SHUFFLE, PLAY_ORDER_SINGLE } from '../constants'\n\nexport const SET_PLAYLIST = 'SET_PLAYLIST'\nexport const CLEAR_PLAYLIST = 'CLEAR_PLAYLIST'\n\nfunction shuffle (original) {\n  const shuffled = [...original]\n  shuffled.sort(() => (Math.random() - 0.5))\n  return shuffled\n}\n\nfunction createSetPlaylistAction (payload) {\n  return {\n    type: SET_PLAYLIST,\n    payload\n  }\n}\n\nfunction pushHistory (historyList, song) {\n  const newHistoryList = [...historyList]\n  const historyIndex = historyList.indexOf(song)\n  if (historyIndex !== -1) {\n    newHistoryList.splice(historyIndex, 1)\n  }\n  newHistoryList.unshift(song)\n  return newHistoryList\n}\n\nfunction id (song) {\n  return song.src instanceof Array\n    ? song.src[0]\n    : song.src\n}\n\nexport function setPlayOrder (playOrder) {\n  return (dispatch, getState) => {\n    const { playlist } = getState()\n    const newPlaylistState = {\n      ...playlist,\n      playOrder\n    }\n    if (playOrder === PLAY_ORDER_SHUFFLE) {\n      const shuffledList = shuffle(playlist.orderedList)\n      const shuffledIndexOfPlaying = shuffledList.indexOf(playlist.playing)\n      newPlaylistState.shuffledList = shuffledList\n      newPlaylistState.shuffledIndexOfPlaying = shuffledIndexOfPlaying\n    }\n    dispatch(createSetPlaylistAction(newPlaylistState))\n  }\n}\n\nexport function nextPlayOrder () {\n  return (dispatch, getState) => {\n    const { playlist } = getState()\n    const currentPlayOrder = playlist.playOrder\n    const currentPlayOrderIndex = PLAY_ORDER.indexOf(currentPlayOrder)\n    const nextPlayOrderIndex = currentPlayOrderIndex + 1 >= PLAY_ORDER.length ? 0 : currentPlayOrderIndex + 1\n    const nextPlayOrder = PLAY_ORDER[nextPlayOrderIndex]\n    setPlayOrder(nextPlayOrder)(dispatch, getState)\n  }\n}\n\nexport function next () {\n  return (dispatch, getState) => {\n    const { playlist } = getState()\n    const newPlaylistState = { ...playlist }\n    if (playlist.playOrder === PLAY_ORDER_SHUFFLE) {\n      if (playlist.shuffledIndexOfPlaying + 1 === playlist.shuffledList.length) {\n        newPlaylistState.shuffledList.push(...shuffle(playlist.orderedList))\n      }\n      newPlaylistState.shuffledIndexOfPlaying++\n      newPlaylistState.playing = newPlaylistState.shuffledList[newPlaylistState.shuffledIndexOfPlaying]\n      newPlaylistState.orderedIndexOfPlaying = playlist.orderedList.indexOf(newPlaylistState.playing)\n    } else {\n      if (playlist.orderedIndexOfPlaying + 1 === playlist.orderedList.length) {\n        newPlaylistState.orderedIndexOfPlaying = 0\n      } else {\n        newPlaylistState.orderedIndexOfPlaying++\n      }\n      newPlaylistState.playing = newPlaylistState.orderedList[newPlaylistState.orderedIndexOfPlaying]\n    }\n    newPlaylistState.historyList = pushHistory(playlist.historyList, newPlaylistState.playing)\n    dispatch(createSetPlaylistAction(newPlaylistState))\n  }\n}\n\nexport function autoNext () {\n  return (dispatch, getState) => {\n    const { playlist } = getState()\n    if (playlist.playOrder === PLAY_ORDER_SINGLE) {\n      dispatch(createSetPlaylistAction(playlist))\n    } else {\n      next()(dispatch, getState)\n    }\n  }\n}\n\nexport function previous () {\n  return (dispatch, getState) => {\n    const { playlist } = getState()\n    const newPlaylistState = { ...playlist }\n    if (playlist.playOrder === PLAY_ORDER_SHUFFLE) {\n      if (playlist.shuffledIndexOfPlaying - 1 === -1) {\n        newPlaylistState.shuffledList.unshift(...shuffle(playlist.orderedList))\n        newPlaylistState.shuffledIndexOfPlaying += playlist.orderedList\n      }\n      newPlaylistState.shuffledIndexOfPlaying--\n      newPlaylistState.playing = newPlaylistState.shuffledList[newPlaylistState.shuffledIndexOfPlaying]\n      newPlaylistState.orderedIndexOfPlaying = playlist.orderedList.indexOf(newPlaylistState.playing)\n    } else {\n      if (playlist.orderedIndexOfPlaying - 1 === -1) {\n        newPlaylistState.orderedIndexOfPlaying = playlist.orderedList.length - 1\n      } else {\n        newPlaylistState.orderedIndexOfPlaying--\n      }\n      newPlaylistState.playing = newPlaylistState.orderedList[newPlaylistState.orderedIndexOfPlaying]\n    }\n    newPlaylistState.historyList = pushHistory(playlist.historyList, newPlaylistState.playing)\n    dispatch(createSetPlaylistAction(newPlaylistState))\n  }\n}\n\nexport function setCurrentSong (song) {\n  return (dispatch, getState) => {\n    const { playlist } = getState()\n    const newPlaylistState = { ...playlist }\n    let songId\n    if (typeof song === 'number') {\n      songId = playlist.orderedList[song]\n    } else if (typeof song === 'string') {\n      songId = song\n    } else {\n      songId = id(song)\n      newPlaylistState.songs[songId] = song\n      if (playlist.orderedList.indexOf(songId) === -1) {\n        newPlaylistState.orderedList.splice(\n          newPlaylistState.orderedIndexOfPlaying + 1, 0, songId\n        )\n      }\n    }\n    newPlaylistState.playing = songId\n    newPlaylistState.orderedIndexOfPlaying = playlist.orderedList.indexOf(songId)\n    if (playlist.playOrder === PLAY_ORDER_SHUFFLE) {\n      newPlaylistState.shuffledList = shuffle(newPlaylistState.orderedList)\n      newPlaylistState.shuffledIndexOfPlaying = newPlaylistState.shuffledList.indexOf(songId)\n    }\n    newPlaylistState.historyList = pushHistory(playlist.historyList, newPlaylistState.playing)\n    dispatch(createSetPlaylistAction(newPlaylistState))\n  }\n}\n\nexport function setNextSong (song) {\n  return (dispatch, getState) => {\n    const { playlist } = getState()\n    const newPlaylistState = { ...playlist }\n    let songId\n    if (typeof song === 'number') {\n      songId = playlist.orderedList[song]\n    } else if (typeof song === 'string') {\n      songId = song\n    } else {\n      songId = id(song)\n      newPlaylistState.songs[songId] = song\n    }\n    if (songId !== playlist.playing) {\n      const orderedIndex = playlist.orderedList.indexOf(songId)\n      if (orderedIndex !== -1) {\n        newPlaylistState.orderedList.splice(orderedIndex, 1)\n      }\n      newPlaylistState.orderedList.splice(\n        newPlaylistState.orderedIndexOfPlaying + 1, 0, songId\n      )\n      if (playlist.playOrder === PLAY_ORDER_SHUFFLE &&\n        !(playlist.shuffledIndexOfPlaying + 1 < playlist.shuffledList.length &&\n          playlist.shuffledList[playlist.shuffledIndexOfPlaying + 1] === songId\n        )\n      ) {\n        newPlaylistState.shuffledList.splice(playlist.shuffledIndexOfPlaying + 1, 0, songId)\n      }\n    }\n    dispatch(createSetPlaylistAction(newPlaylistState))\n  }\n}\n\nexport function removeSong (song) {\n  return (dispatch, getState) => {\n    const { playlist } = getState()\n    const newPlaylistState = { ...playlist }\n    let songId\n    if (typeof song === 'number') {\n      songId = playlist.orderedList[song]\n    } else if (typeof song === 'string') {\n      songId = song\n    } else {\n      songId = id(song)\n    }\n    const orderedIndexReduction = playlist.orderedList.slice(0, playlist.orderedIndexOfPlaying)\n      .filter(item => item === songId).length\n    newPlaylistState.orderedList = playlist.orderedList.filter(item => item !== songId)\n    if (playlist.playOrder === PLAY_ORDER_SHUFFLE) {\n      const shuffledIndexReduction = playlist.shuffledList.slice(0, playlist.shuffledIndexOfPlaying)\n        .filter(item => item === songId).length\n      newPlaylistState.shuffledList = playlist.shuffledList.filter(item => item !== songId)\n      newPlaylistState.shuffledIndexOfPlaying = playlist.shuffledIndexOfPlaying - shuffledIndexReduction\n      newPlaylistState.orderedIndexOfPlaying = newPlaylistState.orderedList.indexOf(\n        newPlaylistState.shuffledList[newPlaylistState.shuffledIndexOfPlaying]\n      )\n    } else {\n      newPlaylistState.orderedIndexOfPlaying = playlist.orderedIndexOfPlaying - orderedIndexReduction\n    }\n    newPlaylistState.playing = newPlaylistState.orderedList[newPlaylistState.orderedIndexOfPlaying]\n    newPlaylistState.historyList = pushHistory(playlist.historyList, newPlaylistState.playing)\n    dispatch(createSetPlaylistAction(newPlaylistState))\n  }\n}\n\nexport function setPlaylist (songs, currentSong, playOrder) {\n  return (dispatch, getState) => {\n    const { playlist } = getState()\n    const newPlaylistState = {\n      ...playlist,\n      songs: {},\n      orderedList: [],\n      orderedIndexOfPlaying: null,\n      shuffledList: [],\n      shuffledIndexOfPlaying: null,\n      playing: null,\n      playOrder: playOrder || playlist.playOrder\n    }\n    for (const song of songs) {\n      const songId = id(song)\n      newPlaylistState.songs[songId] = song\n      newPlaylistState.orderedList.push(songId)\n    }\n    if (newPlaylistState.orderedList.length) {\n      if (currentSong) {\n        let songId\n        if (typeof currentSong === 'number') {\n          songId = newPlaylistState.orderedList[currentSong]\n        } else if (typeof currentSong === 'string') {\n          songId = currentSong\n        } else {\n          songId = id(currentSong)\n        }\n        newPlaylistState.orderedIndexOfPlaying = newPlaylistState.orderedList.indexOf(songId)\n        if (newPlaylistState.playOrder === PLAY_ORDER_SHUFFLE) {\n          newPlaylistState.shuffledList = shuffle(newPlaylistState.orderedList)\n          newPlaylistState.shuffledIndexOfPlaying = newPlaylistState.shuffledList.indexOf(songId)\n          newPlaylistState.playing = songId\n        }\n      } else {\n        if (newPlaylistState.playOrder === PLAY_ORDER_SHUFFLE) {\n          newPlaylistState.shuffledList = shuffle(newPlaylistState.orderedList)\n          newPlaylistState.shuffledIndexOfPlaying = 0\n          newPlaylistState.playing = newPlaylistState.shuffledList[newPlaylistState.shuffledIndexOfPlaying]\n          newPlaylistState.orderedIndexOfPlaying = newPlaylistState.orderedList.indexOf(newPlaylistState.playing)\n        } else {\n          newPlaylistState.orderedIndexOfPlaying = 0\n          newPlaylistState.playing = newPlaylistState.orderedList[newPlaylistState.orderedIndexOfPlaying]\n        }\n      }\n    }\n  }\n}\n\nexport function clearPlaylist () {\n  return {\n    type: CLEAR_PLAYLIST\n  }\n}\n","import { SET_SPEED, SET_VOLUME } from '../actions'\n\nconst initialState = {\n  volume: 1,\n  speed: 1\n}\n\nexport default function (state = initialState, action) {\n  switch (action) {\n    case SET_VOLUME:\n      if (typeof action.payload !== 'number') {\n        return state\n      }\n      action.payload = Math.min(Math.max(action.payload, 0), 1)\n      return {\n        ...state,\n        volume: action.payload\n      }\n    case SET_SPEED:\n      if (typeof action.payload !== 'number') {\n        return state\n      }\n      action.payload = Math.min(Math.max(action.payload, 0), 1)\n      return {\n        ...state,\n        speed: action.payload\n      }\n    default:\n      return state\n  }\n}\n","import { cloneDeep } from 'lodash-es'\n\nimport { CLEAR_PLAYLIST, SET_PLAYLIST } from '../actions'\nimport { PLAY_ORDER_LOOP } from '../constants'\n\nconst initialState = {\n  songs: {},\n  orderedList: [],\n  orderedIndexOfPlaying: null,\n  shuffledList: [],\n  shuffledIndexOfPlaying: null,\n  historyList: [],\n  playing: null,\n  playOrder: PLAY_ORDER_LOOP\n}\n\nexport default function (state = initialState, action) {\n  switch (action) {\n    case SET_PLAYLIST:\n      return cloneDeep(action.payload)\n    case CLEAR_PLAYLIST:\n      return {\n        ...cloneDeep(initialState),\n        playOrder: state.playOrder\n      }\n    default:\n      return state\n  }\n}\n","import { cloneDeep } from 'lodash-es'\n\nimport {\n  CLEAR_PLAYLIST,\n  NEXT_SRC,\n  PAUSE,\n  PLAY,\n  SET_BUFFERED_TIME,\n  SET_CURRENT_TIME,\n  SET_PLAYLIST, SET_TIMES,\n  SET_TOTAL_TIME,\n  TOGGLE_PLAY\n} from '../actions'\n\nconst initialState = {\n  src: null,\n  srcIndex: 0,\n  song: null,\n  currentTime: 0,\n  totalTime: 0,\n  bufferedTime: null,\n  paused: true\n}\n\nexport { initialState as initialPlayingState }\n\nexport default function (state = initialState, action) {\n  switch (action) {\n    case CLEAR_PLAYLIST:\n      return cloneDeep(initialState)\n    case SET_PLAYLIST:\n      return {\n        currentTime: 0,\n        totalTime: 0,\n        paused: state.paused,\n        song: cloneDeep(action.payload.songs[action.payload.playing]),\n        src: action.payload.songs[action.payload.playing].src instanceof Array\n          ? action.payload.songs[action.payload.playing].src[0]\n          : action.payload.songs[action.payload.playing].src,\n        srcIndex: 0\n      }\n    case NEXT_SRC: {\n      const srcId = state.song.src instanceof Array\n        ? state.srcIndex + 1 < state.song.src.length\n          ? state.srcIndex + 1 : 0\n        : 0\n      if (srcId !== state.srcIndex && state.song.src instanceof Array) {\n        return {\n          ...cloneDeep(state),\n          currentTime: 0,\n          totalTime: 0,\n          srcIndex: srcId,\n          src: state.song.src[srcId]\n        }\n      } else return state\n    }\n    case SET_CURRENT_TIME:\n      return {\n        ...cloneDeep(state),\n        currentTime: action.payload\n      }\n    case SET_TOTAL_TIME:\n      return {\n        ...cloneDeep(state),\n        totalTime: action.payload\n      }\n    case SET_BUFFERED_TIME:\n      return {\n        ...cloneDeep(state),\n        bufferedTime: cloneDeep(action.payload)\n      }\n    case SET_TIMES:\n      return {\n        ...cloneDeep(state),\n        currentTime: action.payload.currentTime,\n        totalTime: action.payload.totalTime,\n        bufferedTime: cloneDeep(action.payload.bufferedTime)\n      }\n    case PAUSE:\n      return {\n        ...cloneDeep(state),\n        paused: true\n      }\n    case PLAY:\n      return {\n        ...cloneDeep(state),\n        paused: false\n      }\n    case TOGGLE_PLAY:\n      return {\n        ...cloneDeep(state),\n        paused: !state.paused\n      }\n    default:\n      return state\n  }\n}\n","import { combineReducers } from 'redux'\nimport { cloneDeep } from 'lodash-es'\n\nimport player from './player'\nimport playlist from './playlist'\nimport playing, { initialPlayingState } from './playing'\n\nexport default combineReducers({\n  player,\n  playing,\n  playlist\n})\n\nexport function saveState (state) {\n  const exportedState = cloneDeep(state)\n  delete exportedState.playing\n  return exportedState\n}\n\nexport function loadState (state) {\n  if (!state) return undefined\n  const importedState = cloneDeep(state)\n  importedState.playing = initialPlayingState\n  importedState.playing.song = importedState.playlist.songs[importedState.playlist.playing]\n  importedState.playing.src = importedState.playing.song.src instanceof Array\n    ? importedState.playing.song.src[0]\n    : importedState.playing.song.src\n  return importedState\n}\n","import { applyMiddleware, createStore } from 'redux'\nimport thunk from 'redux-thunk'\nimport { composeWithDevTools } from 'redux-devtools-extension'\n\nimport reducers, { loadState, saveState } from './reducers'\nimport {\n  autoNext, clearPlaylist, next, nextPlayOrder,\n  nextSrc,\n  pause,\n  play, previous, removeSong,\n  setBufferedTime, setCurrentSong, setNextSong,\n  setPlaylist, setPlayOrder,\n  setSpeed, setTimes,\n  setTotalTime,\n  setVolume\n} from './actions'\n\nconst defaultOptions = {\n  audioTagId: 'kokoro-sevice',\n  initializeState: null\n}\n\nexport class Kokoro {\n  get ref () {\n    return this._ref\n  }\n\n  get store () {\n    return this._store\n  }\n\n  get _dispatch () {\n    return this._store.dispatch\n  }\n\n  get getState () {\n    return this._store.getState\n  }\n\n  constructor (options) {\n    const op = Object.assign({}, defaultOptions, options)\n    this._store = op.initializeState\n      ? createStore(reducers, loadState(op.initializeState), composeWithDevTools(applyMiddleware(thunk)))\n      : createStore(reducers, composeWithDevTools(applyMiddleware(thunk)))\n    this._listeners = []\n    this._mount(op.audioTagId)\n  }\n\n  destroy () {\n    this._destroyed = true\n    this._unmount()\n    for (const item of this._listeners) {\n      item.unsub()\n    }\n  }\n\n  subscribe (listener) {\n    const o = this._listeners.find(item => item.listener === listener)\n    if (o) {\n      return o.unsub\n    }\n    const unsub = this._store.subscribe(() => listener(this.getState()))\n    this._listeners.push({\n      listener,\n      unsub\n    })\n    return unsub\n  }\n\n  unsubscribe (listener) {\n    const o = this._listeners.find(item => item.listener === listener)\n    if (o) {\n      o.unsub()\n      this._listeners = this._listeners.filter(item => item.listener !== listener)\n    }\n  }\n\n  dumpState () {\n    return saveState(this.getState())\n  }\n\n  _mount (id) {\n    this._ref = document.createElement('audio')\n    if (id) this._ref.id = id\n\n    this._ref.addEventListener('canplay', () => {\n      this._dispatch(setBufferedTime(this._ref.buffered))\n    })\n    this._ref.addEventListener('canplaythrough', () => {\n      this._dispatch(setBufferedTime(this._ref.buffered))\n    })\n    this._ref.addEventListener('durationchange', () => {\n      this._dispatch(setTotalTime(this._ref.duration))\n    })\n    this._ref.addEventListener('ended', () => {\n      this._dispatch(autoNext())\n      this._onSrcProbablyChanged()\n    })\n    this._ref.addEventListener('error', () => {\n      const state = this.getState()\n      if (state.playing.song.src instanceof Array &&\n        state.playing.srcIndex + 1 < state.playing.song.src.length) {\n        this._dispatch(nextSrc())\n      } else {\n        this._dispatch(autoNext())\n      }\n      this._onSrcProbablyChanged()\n    })\n    this._ref.addEventListener('loadedmetadata', () => {\n      this._dispatch(setTotalTime(this._ref.duration))\n    })\n    this._ref.addEventListener('pause', () => {\n      this._dispatch(pause())\n    })\n    this._ref.addEventListener('play', () => {\n      this._dispatch(play())\n    })\n    this._ref.addEventListener('progress', () => {\n      this._dispatch(setBufferedTime(this._ref.buffered))\n    })\n    this._ref.addEventListener('ratechange', () => {\n      this._dispatch(setSpeed(this._ref.playbackRate))\n    })\n    this._ref.addEventListener('timeupdate', () => {\n      this._dispatch(setTimes({\n        currentTime: this._ref.currentTime,\n        totalTime: this._ref.duration,\n        bufferedTime: this._ref.buffered\n      }))\n    })\n    this._ref.addEventListener('volumechange', () => {\n      this._dispatch(setVolume(this._ref.volume))\n    })\n\n    document.body.appendChild(this._ref)\n  }\n\n  _unmount () {\n    this._ref.remove()\n  }\n\n  _onSrcProbablyChanged () {\n    const state = this.getState()\n    if (state.playing.src !== this._ref.src) {\n      this._ref.src = state.playing.src\n    }\n    this._ref.currentTime = state.playing.currentTime\n  }\n\n  pause () {\n    this._ref.pause()\n  }\n\n  play () {\n    this._ref.play()\n  }\n\n  togglePlay () {\n    const state = this.getState\n    if (state.playing.paused) {\n      this._ref.play()\n    } else this._ref.pause()\n  }\n\n  setCurrentTime (time) {\n    this._ref.currentTime = time\n  }\n\n  next () {\n    this._dispatch(next())\n    this._onSrcProbablyChanged()\n  }\n\n  previous () {\n    this._dispatch(previous())\n    this._onSrcProbablyChanged()\n  }\n\n  setPlayOrder (playOrder) {\n    this._dispatch(setPlayOrder(playOrder))\n  }\n\n  nextPlayOrder () {\n    this._dispatch(nextPlayOrder())\n  }\n\n  setCurrentSong (song) {\n    this._dispatch(setCurrentSong(song))\n    this._onSrcProbablyChanged()\n  }\n\n  setNextSong (song) {\n    this._dispatch(setNextSong(song))\n  }\n\n  removeSong (song) {\n    this._dispatch(removeSong(song))\n    this._onSrcProbablyChanged()\n  }\n\n  setPlaylist (songs, currentSong, playOrder) {\n    this._dispatch(setPlaylist(songs, currentSong, playOrder))\n    this._onSrcProbablyChanged()\n  }\n\n  clearPlaylist () {\n    this._dispatch(clearPlaylist())\n    this._onSrcProbablyChanged()\n  }\n\n  setVolume (volume) {\n    this._ref.volume = volume\n  }\n\n  setSpeed (speed) {\n    this._ref.playbackRate = speed\n  }\n}\n\nexport default Kokoro\n\nexport * from './constants'\nexport * as actions from './actions'\n"],"names":["SET_VOLUME","SET_SPEED","setVolume","volume","type","payload","setSpeed","speed","PAUSE","PLAY","TOGGLE_PLAY","SET_CURRENT_TIME","SET_TOTAL_TIME","SET_BUFFERED_TIME","SET_TIMES","NEXT_SRC","pause","play","togglePlay","setCurrentTime","time","setTotalTime","setBufferedTime","buffered","setTimes","times","nextSrc","LYRICS_TYPE_LRC","LYRICS_TYPE_L2C","PLAY_ORDER_LOOP","PLAY_ORDER_SINGLE","PLAY_ORDER_SHUFFLE","PLAY_ORDER","SET_PLAYLIST","CLEAR_PLAYLIST","shuffle","original","shuffled","sort","Math","random","createSetPlaylistAction","pushHistory","historyList","song","newHistoryList","historyIndex","indexOf","splice","unshift","id","src","Array","setPlayOrder","playOrder","dispatch","getState","playlist","newPlaylistState","shuffledList","orderedList","shuffledIndexOfPlaying","playing","nextPlayOrder","currentPlayOrder","currentPlayOrderIndex","nextPlayOrderIndex","length","next","push","orderedIndexOfPlaying","autoNext","previous","setCurrentSong","songId","songs","setNextSong","orderedIndex","removeSong","orderedIndexReduction","slice","filter","item","shuffledIndexReduction","setPlaylist","currentSong","clearPlaylist","initialState","state","action","min","max","cloneDeep","srcIndex","currentTime","totalTime","bufferedTime","paused","srcId","combineReducers","player","saveState","exportedState","loadState","undefined","importedState","initialPlayingState","defaultOptions","audioTagId","initializeState","Kokoro","_ref","_store","options","op","Object","assign","createStore","reducers","composeWithDevTools","applyMiddleware","thunk","_listeners","_mount","_destroyed","_unmount","unsub","listener","o","find","subscribe","document","createElement","addEventListener","_dispatch","duration","_onSrcProbablyChanged","playbackRate","body","appendChild","remove"],"mappings":"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"}